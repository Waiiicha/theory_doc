<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>MPC稳定性的应用 - 理论知识库</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "MPC\u7a33\u5b9a\u6027\u7684\u5e94\u7528";
    var mkdocs_page_input_path = "\u6a21\u578b\u9884\u6d4b\u63a7\u5236/05-MPC\u7a33\u5b9a\u6027\u7684\u5e94\u7528.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> 理论知识库</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="tocbase current">
    
    
      


  <li class="navtree toctree-l1 inactive">
    <a class="" href="../..">Welcome to MkDocs</a>
  </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">强化学习</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0/%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/">基础概念</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">模型预测控制</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../01-%E5%B8%B8%E7%94%A8%E5%AE%9A%E7%90%86%E3%80%81%E7%9F%A9%E9%98%B5/">常用定理、矩阵</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../02-%E7%BA%BF%E6%80%A7%E6%97%A0%E7%BA%A6%E6%9D%9FMPC%E7%A8%B3%E5%AE%9A%E6%80%A7%E6%8E%A8%E5%AF%BC/">线性无约束MPC稳定性推导</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../03-%E6%9C%89%E9%99%90%E6%97%B6%E5%9F%9F%E7%BA%BF%E6%80%A7%E6%9C%89%E7%BA%A6%E6%9D%9FMPC%E7%A8%B3%E5%AE%9A%E6%80%A7%E6%8E%A8%E5%AF%BC/">有限时域线性有约束MPC稳定性推导</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../04-MPC%E7%BB%88%E7%AB%AF%E9%9B%86%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%B3%95/">MPC 终端集设计方法</a>
  </li>
        
          


  
    
    <li class="navtree toctree-l2 page current">
      <a class="current" href="./">
        MPC稳定性的应用
          <span class="toctree-expand"></span>
      </a>
    </li>
    
      



  <li class="toctree-l2 current">
    <ul class="subnav-l2 current">
    
      
          

  <li class="toctree-l3 current with-children">
    <a href="#robust-mpctube-based-mpc">
      Robust MPC/Tube-based MPC
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l3 current">
    <ul class="subnav-l3 current">
    
      
        <li class="toctree-l4">
          <a class="toctree-l5" href="#_1">问题描述</a>
        </li>
    
      
        <li class="toctree-l4">
          <a class="toctree-l5" href="#_2">稳定性修正</a>
        </li>
    
    </ul>
  </li>

      
    
      
          

  <li class="toctree-l3">
    <a href="#predictive-safety-filter-psf">
      预测安全滤波器 (Predictive safety filter, PSF)
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l3">
    <ul class="subnav-l3 toc-hidden">
    
      
        <li class="toctree-l4">
          <a class="toctree-l5" href="#psf">标准线性模型PSF</a>
        </li>
    
      
        <li class="toctree-l4">
          <a class="toctree-l5" href="#psf_1">线性误差模型PSF</a>
        </li>
    
    </ul>
  </li>

      
    
    </ul>
  </li>


  
        
      </ul>
    </li>
    
  </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">理论知识库</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>模型预测控制 &raquo;</li>
        
      
    
    <li>MPC稳定性的应用</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="mpc">MPC稳定性的应用</h1>
<hr />
<h2 id="robust-mpctube-based-mpc">Robust MPC/Tube-based MPC</h2>
<h3 id="_1">问题描述</h3>
<p>Robust MPC主要用于处理预测模型不准确，且不准确性有界时的问题。</p>
<p>真实模型(Real model)表示为：</p>
<div class="arithmatex">\[
\begin{aligned}
x(k+1) &amp;= A x(k) + B u(k) + D w(k)， \\
w(k) &amp;\in \mathcal W,\  \forall i = 0,1,\ldots, N-1.\\
\end{aligned}
\]</div>
<p>标称模型(Norminal model)表示为：</p>
<p>$$
  z(k+1) = A z(k) + B v(k)，
$$
其中，<span class="arithmatex">\(z(0) = x(0)\)</span>。</p>
<p>Robust MPC的基本结构是“标称MPC+线性反馈控制”。设反馈控制律为：<span class="arithmatex">\(-K_{\mathcal E}(x(k) - z(k))\)</span>，可以得到误差模型：</p>
<p>$$
\begin{aligned}
e(k+1) &amp;= (A - B K_{\mathcal E}) e(k) + D w(k)， \
&amp;= A_K e(k) + D w(k),
\end{aligned}
$$
其中，<span class="arithmatex">\(e(k) = x(k) - z(k), \  u(k) = v(k) - K_{\mathcal E}(x(k) - z(k))\)</span>，<span class="arithmatex">\(K_{\mathcal E}\)</span>满足<span class="arithmatex">\(|\text{eig}( A -  B K)| &lt; 1\)</span>。</p>
<h3 id="_2">稳定性修正</h3>
<p>由于初始时刻会直接用采集到的真实状态作为标称模型的输入，即<span class="arithmatex">\(x(0) - z(0)\)</span>，因此根据误差模型的递推关系可以得到：</p>
<div class="arithmatex">\[
\begin{aligned}
e(0) &amp;= x(0) - z(0) = 0, \\
e(1) &amp;= A_K e(0) + D w(0) = D w(0), \\
e(2) &amp;= A_K e(1) + D w(1) = A_K D w(0) + D w(1), \\
e(3) &amp;= A_K e(2) + D w(2)= A_K^2 D w(0) + A_K D w(1) + D w(2), \\
&amp;\vdots \\
e(k) &amp;= \cdots = \sum_{i=1}^{k} A_K^{i-1} D w_{k-j}.
\end{aligned}
\]</div>
<p>又因为<span class="arithmatex">\(|\text{eig}( A -  B K)| &lt; 1\)</span>，且<span class="arithmatex">\(w_k\)</span>有界(<span class="arithmatex">\(w(i|k) \in \mathcal W\)</span>)，故：</p>
<div class="arithmatex">\[
  \begin{aligned}
    e(k) &amp;= \sum_{i=1}^{k} A_K^{i-1} D w_{i-1} \in \sum_{i=1}^{k} A_K^{i-1} D \mathcal{W} \subset \sum_{i=1}^{\infty} A_K^{i-1} D \mathcal{W}, \\
    \mathcal E &amp;:= \sum_{i=1}^{\infty} A_K^{i-1} D \mathcal{W} \subset \Omega.
  \end{aligned}
\]</div>
<p>由于<span class="arithmatex">\(\mathcal E\)</span>是有限集，因此误差<span class="arithmatex">\(e(k)\)</span>有界，并且<span class="arithmatex">\(\mathcal E\)</span>是<span class="arithmatex">\(e(k)\)</span>的不变集。</p>
<p>因为<span class="arithmatex">\(e \in \mathcal E\)</span>，所以<span class="arithmatex">\(K_{\mathcal E} e \in K_{\mathcal E} \mathcal E\)</span>。为了保证<span class="arithmatex">\(x \in \mathcal X, u \in \mathcal U\)</span>，闭环标称系统需要满足：</p>
<div class="arithmatex">\[
  \begin{aligned}
    z \in \mathcal Z = \mathcal X \ominus \mathcal E,\\
    v \in \mathcal V = \mathcal U \ominus K_{\mathcal E} \mathcal E.
  \end{aligned}
\]</div>
<p>同时，为了保证标称系统的稳定性，标称系统的终端集需要是不变集：</p>
<div class="arithmatex">\[
  z(N|k) \in \mathcal Z_f \subset \Omega.
\]</div>
<div class="admonition note">
<p><span class="arithmatex">\(Z_f\)</span>的求法和正常终端集一致。</p>
</div>
<div class="admonition note">
<p>由于标称模型的终端状态<span class="arithmatex">\(z_N\)</span>和误差模型的状态<span class="arithmatex">\(z_k\)</span>都在不变集内，因此真实模型的终端状态<span class="arithmatex">\(x_N\)</span>也在不变集(<span class="arithmatex">\(\mathcal Z_f \oplus \mathcal E\)</span>)内，因此可以保证稳定性。</p>
</div>
<p>综上所述，Robust MPC问题可以表示为：</p>
<div class="arithmatex">\[
  \begin{aligned}
  \min_{u(i|k)} J = &amp; \sum_{i=1}^{N-1} \left\|  z(i|k) \right\|_{ Q}^2 + \sum_{i=1}^{N} \left\|  v(i-1|k) \right\|_{ R}^2 + \left\|  z(N|k) \right\|_{P}^2 \\
  \text{subj.to.} \quad &amp;  z(0) =  x(0), \\
  &amp; z(i|k) \in \mathcal X \ominus \mathcal E, \  \forall i = 1,2,\ldots, N,\\
  &amp; v(i|k) \in \mathcal U \ominus K_{\mathcal E} \mathcal E, \  \forall i = 0,1,\ldots, N-1,\\
  &amp; z(i+1|k) =  A  z(i|k) +  B v(i|k), \  \forall i = 0,1,\ldots, N-1,\\
  &amp; z(N|k) \in \mathcal Z_f \subset  \Omega. 
  \end{aligned}
\]</div>
<div class="admonition note">
<p><span class="arithmatex">\(K_{\mathcal E}\)</span>可以直接用LQR来求，<span class="arithmatex">\(\mathcal E\)</span>可以通过某些手段求解。</p>
</div>
<h2 id="predictive-safety-filter-psf">预测安全滤波器 (Predictive safety filter, PSF)</h2>
<p>PSF的目的是对已有的控制量<span class="arithmatex">\(u_{\mathcal{L}}\)</span>进行修正，计算新的控制量<span class="arithmatex">\(u_{\mathcal{S}}\)</span>，使得被控系统能够在未来一段时间<span class="arithmatex">\(N\)</span>内始终满足控制量、状态量约束，并且状态量能够收敛到安全终端集<span class="arithmatex">\(\mathcal S_f\)</span>内。</p>
<p>PSF和MPC稳定性修正的最本质区别是PSF不保证被控系统的稳定性，只保证状态量处于安全约束内，所以PSF的代价函数和MPC差别很大，并且不需要终端代价。</p>
<h3 id="psf">标准线性模型PSF</h3>
<p>标准线性模型的PSF的MPC问题表示如下：</p>
<p><a id="eq:norm_PSF"></a></p>
<div class="arithmatex">\[
  \begin{aligned}
  \min_{u_{i|k}} J = &amp; \left\|  u_{\mathcal{L}} - u_{0|k} \right\|_W^2\\
  \text{subj.to.} \quad &amp;  x_{0|k} =  x(k), \\
  &amp; x_{i|k} \in \mathcal X \subset \{x \in R^{n_x} |  H_x x \leq h_x \}, \  \forall i = 1,2,\ldots, N,\\
  &amp; u_{i|k} \in \mathcal U \subset \{u \in R^{n_u} |  H_u u \leq h_u \}, \  \forall i = 0,1,\ldots, N-1,\\
  &amp; x_{i+1|k} =  A  x_{i|k} +  B  u_{i|k}, \  \forall i = 0,1,\ldots, N-1,\\
  &amp; x_{N|k} \in \mathcal S_f \subset  \Omega. 
  \end{aligned}
\]</div>
<p>终端安全集<span class="arithmatex">\(\mathcal S_f\)</span>具有如下性质：存在一个控制律 <span class="arithmatex">\( u_f: \mathcal S_f \to \mathcal U \)</span>，以及一个对应的正不变集 <span class="arithmatex">\( \mathcal S_f \subseteq \mathcal{X} \)</span>，使得对于所有 <span class="arithmatex">\( x \in \mathcal S_f \)</span>，都有 <span class="arithmatex">\( u_f(x) \in \mathcal U \)</span> 且 <span class="arithmatex">\( f(x, u_f(x)) \in \mathcal S_f \)</span>。</p>
<p>每次求解<a href="#eq:norm_PSF">优化问题</a>时，</p>
<ul>
<li>若有可行解，则令<span class="arithmatex">\(u_{\mathcal{S}} = u_{0|k}^*\)</span>，并定义<span class="arithmatex">\(\bar k = k\)</span>，储存<span class="arithmatex">\( \bar k \)</span>时刻的N个最优控制序列；</li>
<li>若无可行解，<ul>
<li>如果$ k - \bar k \leq N-1$，令 <span class="arithmatex">\(u_{\mathcal{S}} = u_{k- \bar k|\bar k}^*\)</span>；</li>
<li>如果$ k - \bar k &gt; N-1$，令 <span class="arithmatex">\(u_{\mathcal{S}} = u_f(x(k))^*\)</span>。</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p><span class="arithmatex">\(u_f\)</span>和<span class="arithmatex">\(\mathcal S_f\)</span>的求法和稳定性证明中的终端集一致。</p>
</div>
<h3 id="psf_1">线性误差模型PSF</h3>
<p>线性误差模型PSF的表达式与Tube-MPC基本一致，其核心都是需要令标称模型的约束集等于“真实的约束集合”<span class="arithmatex">\(\ominus\)</span>“模型误差的不变集”。标称模型终端控制律变为：存在一个控制律 <span class="arithmatex">\( v_f: \mathcal S_f \ominus \mathcal{E} \to \mathcal U \ominus K_{\mathcal{E}} \mathcal{E} \)</span>，以及一个对应的正不变集 <span class="arithmatex">\( \mathcal S_f \subseteq \mathcal{X} \)</span>，使得对于所有 <span class="arithmatex">\( z \in \mathcal S_f \ominus \mathcal{E} \)</span>，都有 <span class="arithmatex">\( v_f(x) \in \mathcal U \ominus K_{\mathcal{E}} \mathcal{E} \)</span> 且 <span class="arithmatex">\( f(x, v_f(x)) \in \mathcal S_f \ominus \mathcal{E} \)</span>。</p>
<p>线性误差模型PSF表示形式如下：</p>
<div class="arithmatex">\[
  \begin{aligned}
  \min_{v_{i|k}} \quad  &amp; J = \left\|  u_{\mathcal{L}} - u_{0|k} \right\|_W^2\\
  \text{subj.to.} \quad &amp;  x_{0|k} =  x(k), \\
  &amp; z_{i|k} \in \mathcal X \ominus \mathcal{E}, \  \forall i = 1,2,\ldots, N,\\
  &amp; v_{i|k} \in \mathcal U \ominus K_{\mathcal{E}} \mathcal{E}, \  \forall i = 0,1,\ldots, N-1,\\
  &amp; z_{i+1|k} =  A  z_{i|k} +  B  v_{i|k}, \  \forall i = 0,1,\ldots, N-1,\\
  &amp; u_{0|k} = v_{0|k} -K_{\mathcal{E}}\left(x(k) - z_{k- \bar k|\bar{k}}\right),\\
  &amp; z_{N|k} \in \mathcal Z_f =  \mathcal S_f \ominus \mathcal{E} \subset  \Omega. 
  \end{aligned}
\]</div>
<p>每次求解上述优化问题时，</p>
<ul>
<li>若有可行解，则令<span class="arithmatex">\(u_{\mathcal{S}} = u_{0|k}^*\)</span>，并定义 <span class="arithmatex">\(\bar k = k\)</span>，储存<span class="arithmatex">\( \bar k \)</span>时刻的N个最优标称控制序列；</li>
<li>若无可行解，<ul>
<li>如果$ k - \bar k \leq N-1$，令 <span class="arithmatex">\(u_{\mathcal{S}} = v_{k- \bar k|\bar k}^* - K_{\mathcal{E}}\left(x(k) - z_{k- \bar k|\bar k}\right)\)</span>；</li>
<li>如果$ k - \bar k &gt; N-1$，令 <span class="arithmatex">\(u_{\mathcal{S}} =  - K_{\mathcal{E}}\left(x(k) - z_{k- N|\bar k}\right)\)</span>。</li>
</ul>
</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../04-MPC%E7%BB%88%E7%AB%AF%E9%9B%86%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%B3%95/" class="btn btn-neutral" title="MPC 终端集设计方法"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../04-MPC%E7%BB%88%E7%AB%AF%E9%9B%86%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%B3%95/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/contrib/auto-render.min.js" defer></script>
      <script src="../../javascripts/katex-init.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
